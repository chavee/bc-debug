var Alloy=require("/alloy"),
Backbone=Alloy.Backbone,
_=Alloy._;




function __processArg(obj,key){
var arg=null;



return obj&&(arg=obj[key]||null),arg;
}

function Controller(){var _Mathfloor=











































































































































































































































































Math.floor;function resetStateBeacon(){Ti.App.Properties.setString("inetBeaconData_major",null),Ti.App.Properties.setString("inetBeaconData_minor",null),Ti.App.Properties.setString("inetBeaconData_uuid",null)}function setStateBeacon(uuid,minor,major){Ti.App.Properties.setString("inetBeaconData_major",major),Ti.App.Properties.setString("inetBeaconData_minor",minor),Ti.App.Properties.setString("inetBeaconData_uuid",uuid)}function isSameStateBefore(uuid,minor,major){return uuid==Ti.App.Properties.getString("inetBeaconData_uuid")&&major==Ti.App.Properties.getString("inetBeaconData_major")&&minor==Ti.App.Properties.getString("inetBeaconData_minor")}function isInterestedRegion(rssi){tag="isInterestRegion:";let min_rssi=-96;return!(-96>=rssi)}function beaconStartScan(){if(resetStateBeacon(),!0){var permissions=["android.permission.ACCESS_FINE_LOCATION"];Ti.Android.requestPermissions(permissions,function(e){e.success?console.log("allow location success"):console.log("not allow location")}),console.log("after check perm:",_Mathfloor(Date.now())),

androidBindingCallback=function(e){
tag="androidBindingCallback: ",
console.log(tag,e);
},

inBeconRange=function(e){
var tag="beaconRanges: ";
console.log("beaconRanges: ","I am in the "+e.identifier+" region"),
console.log("beaconRanges: ","I see "+e.beacons.length+" beacons in this region:"),
console.log("beaconRanges: ","----------------"),
e.beacons.forEach(function(beacon,index){


console.log("beaconRanges: ","Beacon number: "+index),
console.log("beaconRanges: ","uuid: "+beacon.uuid),
console.log("beaconRanges: ","major: "+beacon.major),
console.log("beaconRanges: ","minor: "+beacon.minor),
console.log("beaconRanges: ","proximity: "+beacon.proximity),
console.log("beaconRanges: ","accuracy: "+beacon.accuracy),
console.log("beaconRanges: ","rssi: "+beacon.rssi),
console.log("beaconRanges: ","power: "+beacon.power),
console.log("----------------");

var beacon_key=beacon.major+"-"+beacon.minor;
beacon_key in global_beacons?

console.log(beacon_key+" beacon was recorded"):



isInterestedRegion(beacon.rssi)?(

console.log("beaconRanges: ","call location api"),
global_beacons[beacon_key]={
major:beacon.major,
minor:beacon.minor,
rssi:beacon.rssi,
location:"\u0E01\u0E33\u0E25\u0E31\u0E07\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E15\u0E33\u0E41\u0E2B\u0E19\u0E48\u0E07",
isRegistered:!1,
ts:new Date().getTime()},


getLocation(beacon.major,beacon.minor,beacon_key)):



console.log("Not interesed region.");


});
},

BLE.addEventListener("beaconRanges",inBeconRange);

var regionState=function(e){
var tag="regionState: ";
console.log("regionState: ","identifer: "+e.regionState);
};

BLE.addEventListener("onIBeaconServiceConnect",androidBindingCallback),

console.log("add evnt complete:",_Mathfloor(Date.now()));var

when_ready,
not_ready_count=0;

BLE.bindBeaconService(),

when_ready=setInterval(function(){return(
BLE.isReady()?(







Ti.API.info("Try",not_ready_count,"time, ","Okay! Module is ready!"),


BLE.checkAvailability()?void(





BLE.setBackgroundMode(!1),
BLE.setScanPeriods({
foregroundScanPeriod:5e3,
foregroundBetweenScanPeriod:200,
backgroundScanPeriod:5e3,
backgroundBetweenScanPeriod:200}),


BLE.startMonitoringForRegion({
identifier:beaconIdentifier,
uuid:beaconUUID}),


clearInterval(when_ready),
when_ready=null):void alert("It's not support in your device!")):(console.log("not_ready_count=",not_ready_count),console.log("BLE Not ready"),void not_ready_count++));
},1e3);

var monit;

monit=setInterval(function(){

if(!1)


return console.log("App in background. Stop scan."),void BLE.stopScan();

});

}else if(iosDidChangeAuthorization=(e)=>{switch(Ti.API.info("didChangeAuthorization"),e.state){case BLE.LOCATION_MANAGER_AUTHORIZATION_STATUS_AUTHORIZED_ALWAYS:alert("Manager authorization is always");break;case BLE.LOCATION_MANAGER_AUTHORIZATION_STATUS_AUTHORIZED_WHEN_IN_USE:alert("Manager authorization is when in use");break;case BLE.LOCATION_MANAGER_AUTHORIZATION_STATUS_DENIED:alert("Manager authorization is denied");break;case BLE.LOCATION_MANAGER_AUTHORIZATION_STATUS_NOT_DETERMINED:alert("Manager authorization is not determined");break;case BLE.LOCATION_MANAGER_AUTHORIZATION_STATUS_RESTRICTED:alert("Manager authorization is powered restricted");break;default:alert("Unknown");}},iosDidRangeBeacons=(e)=>{Ti.API.info("didRangeBeacons");var becaons=e.beacons;if(0===becaons.length)return console.log("No beacon in range"),void(null!==Ti.App.Properties.getString("inetBeaconData_uuid")&&(alert("Exit uuid: "+Ti.App.Properties.getString("inetBeaconData_uuid")+"  Major: "+Ti.App.Properties.getString("inetBeaconData_major")+"  Minor: "+Ti.App.Properties.getString("inetBeaconData_minor")),resetStateBeacon()));var proximity=becaons[0].proximity,accuracy=becaons[0].accuracy,major=becaons[0].major,minor=becaons[0].minor,haveCase=!0;(isInterestedRegion(proximity)||console.log("Too far..."),!isSameStateBefore(e.region.uuid,major,minor))&&(proximity===BLE.BEACON_PROXIMITY_UNKNOWN?alert("Beacon Location : UNKNOWN"):proximity===BLE.BEACON_PROXIMITY_IMMEDIATE?(setStateBeacon(e.region.uuid,major,minor),console.log(e.region.uuid+" Major: "+major+" Minor: "+minor),alert("IMMEDIATE uuid: "+e.region.uuid+"  Major: "+major+"  Minor: "+minor+"  Approx: "+accuracy+"m)")):proximity===BLE.BEACON_PROXIMITY_NEAR?(setStateBeacon(e.region.uuid,major,minor),console.log(e.region.uuid+" Major: "+major+" Minor: "+minor),alert("NEAR uuid: "+e.region.uuid+"  Major: "+major+"  Minor: "+minor+"  Approx: "+accuracy+"m)")):proximity===BLE.BEACON_PROXIMITY_FAR?(setStateBeacon(e.region.uuid,major,minor),console.log(e.region.uuid+" Major: "+major+" Minor: "+minor),alert("FAR uuid: "+e.region.uuid+"  Major: "+major+"  Minor: "+minor+"  Approx: "+accuracy+"m)")):(haveCase=!1,alert("Beacon Location : UNKNOWN")),haveCase)},null===manager){manager=BLE.createRegionManager(),manager.addEventListener("didChangeAuthorization",iosDidChangeAuthorization),manager.addEventListener("didRangeBeacons",iosDidRangeBeacons);var beaconRegion=BLE.createBeaconRegion({uuid:beaconUUID,identifier:beaconIdentifier});manager.startRegionMonitoring({beaconRegion:beaconRegion}),manager.startRangingBeaconsInRegion({beaconRegion:beaconRegion})}
}

















function beaconStopScan(){
resetStateBeacon(),1?(







BLE.stopMonitoringAllRegions(),
BLE.removeEventListener("beaconRanges",inBeconRange)):(manager.removeEventListener("didChangeAuthorization",iosDidChangeAuthorization),manager.removeEventListener("didRangeBeacons",iosDidRangeBeacons));

}

function getLocation(this_major,this_minor,this_key){
tag="getLocation: ";var
xhr=Ti.Network.createHTTPClient(),

my_loc_code=md5_hash(`b1cf4b7ec203:1:${this_major}:${this_minor}`);
console.log(tag+"my_hash: "+my_loc_code+" major:"+this_major+" minor:"+this_minor),

xhr.onload=function(e){
var res_json={};
console.log(tag,this.status),
console.log(tag,this.responseText),

res_json=JSON.parse(this.responseText),
global_beacons[this_key].isRegistered=!0,
console.log(tag,"res_json=",res_json),


global_beacons[this_key].location="site_name"in res_json?res_json.site_name:



"-",

"location_name"in res_json&&(

global_beacons[this_key].location=global_beacons[this_key].location+" "+res_json.location_name),

alert(tag+this_key+":"+global_beacons[this_key].location);
},

xhr.onerror=function(e){
console.log(tag,this.status),
console.log(tag,this.responseText),


global_beacons[this_key].location=(this.status=404)?`ไม่พบตำแหน่ง ${global_beacons[this_key].major}/${global_beacons[this_key].major} ในระบบ`:



"\u0E01\u0E23\u0E38\u0E13\u0E32\u0E25\u0E2D\u0E07\u0E43\u0E2B\u0E21\u0E48";

},
xhr.timeout=1e4,
xhr.open("GET","https://beacon-track.inet.co.th/beaconinfo?code="+my_loc_code),
xhr.setRequestHeader("content-type","application/json"),
xhr.send();
}

function sortByProperty(property){
var tag="sortByProp: ";
return function(a,b){return(
a[property]>b[property]?(


console.log(a.location+" "+a[property]+">"+b.location+" "+b[property]),
-1):

a[property]<b[property]?(


console.log(a.location+" "+a[property]+"<"+b.location+" "+b[property]),
1):

0);
};
}

function getLocationList()
{var
tag="getLocationList: ",
global_location=[],
location_list="";


for(var prop in global_beacons)
console.log("getLocationList: ","beacon ",global_beacons[prop]),

global_beacons[prop].isRegistered&&


global_location.push(global_beacons[prop]);









































return console.log("getLocationList: ","global_location=",global_location),global_location.sort(sortByProperty("rssi")),global_location.forEach(function(sort_loc,index){console.log("getLocationList: ","### sort_id=",index,"data=",sort_loc),location_list=location_list+sort_loc.location+" major="+sort_loc.major+" minor="+sort_loc.minor+" rssi="+sort_loc.rssi+"; "}),alert("getLocationList: sorted_loc="+location_list),global_location;
}

function md5_hash(hash_seed){var
tag="md5_hash",
my_md5=Ti.Utils.md5HexDigest(hash_seed);
return my_md5;
}if(require("/alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="inet_beacon/beacon",this.args=arguments[0]||{},arguments[0])var __parentSymbol=__processArg(arguments[0],"__parentSymbol"),$model=__processArg(arguments[0],"$model"),__itemTemplate=__processArg(arguments[0],"__itemTemplate");var $=this,exports={},__defers={};exports.destroy=function(){},_.extend($,$.__views);let beaconUUID="5991e161-bb46-432f-9bd8-b271f76f67d9",beaconIdentifier="Morprom",global_beacons={};Ti.App.Properties.setString("f_beacon",""),console.log("begin:",_Mathfloor(Date.now()));var BLE=null,isForeground=!0;BLE=1?require("com.liferay.beacons"):require("appcelerator.ble"),console.log("after lode lib:",_Mathfloor(Date.now()));var manager=null,iosDidRangeBeacons=null,iosDidChangeAuthorization=null,inBeconRange=null,clearBCCache=setInterval(function(){var tag="timeToClearBCCach?: ";for(var prop in global_beacons)console.log("timeToClearBCCach?: "+global_beacons[prop].location+" ts="+global_beacons[prop].ts+" ms"),300000<new Date().getTime()-global_beacons[prop].ts?(console.log("Yes, clear beacon cache."),delete global_beacons[prop]):console.log("timeToClearBCCach?: No.")},5e3);

exports.beaconStartScan=beaconStartScan,
exports.beaconStopScan=beaconStopScan,
exports.getLocationList=getLocationList,









_.extend($,exports);
}

module.exports=Controller;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlbXBsYXRlLmpzIiwiYmVhY29uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEdBQUEsQ0FBQSxLQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxLQUFBLENBQUEsUUFEQTtBQUVBLENBQUEsQ0FBQSxLQUFBLENBQUEsQ0FGQTs7Ozs7QUFPQSxRQUFBLENBQUEsWUFBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxHQUFBLENBQUEsR0FBQSxDQUFBLElBQUE7Ozs7QUFJQSxNQUhBLENBQUEsR0FHQSxHQUZBLEdBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsSUFFQSxFQUFBLEdBQUE7QUFDQTs7QUFFQSxRQUFBLENBQUEsVUFBQSxFQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDZ09BLElBQUEsQ0FBQSxLRGhPQSxDQ1JBLFFBQUEsQ0FBQSxnQkFBQSxFQUFBLENBQ0EsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHNCQUFBLENBQUEsSUFBQSxDQURBLENBRUEsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHNCQUFBLENBQUEsSUFBQSxDQUZBLENBR0EsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHFCQUFBLENBQUEsSUFBQSxDQUNBLENBQ0EsUUFBQSxDQUFBLGNBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUNBLEVBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxDQUFBLFNBQUEsQ0FBQSxzQkFBQSxDQUFBLEtBQUEsQ0FEQSxDQUVBLEVBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxDQUFBLFNBQUEsQ0FBQSxzQkFBQSxDQUFBLEtBQUEsQ0FGQSxDQUdBLEVBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxDQUFBLFNBQUEsQ0FBQSxxQkFBQSxDQUFBLElBQUEsQ0FDQSxDQUNBLFFBQUEsQ0FBQSxpQkFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDQUFBLE9BRUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHFCQUFBLENBQUEsRUFDQSxLQUFBLEVBQUEsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHNCQUFBLENBREEsRUFFQSxLQUFBLEVBQUEsRUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLENBQUEsU0FBQSxDQUFBLHNCQUFBLENBS0EsQ0FlQSxRQUFBLENBQUEsa0JBQUEsQ0FBQSxJQUFBLENBQ0EsQ0FDQSxHQUFBLENBQUEsbUJBREEsQ0FFQSxHQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsRUFBQSxDQUZBLFFBVUEsS0FBQSxJQVZBLENBcUJBLENBVUEsUUFBQSxDQUFBLGVBQUEsRUFBQSxDQUVBLEdBREEsZ0JBQUEsRUFDQSxJQXdKQSxDQUdBLEdBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSx5Q0FBQSxDQUFBLENBQ0EsRUFBQSxDQUFBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLFdBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxDQUNBLENBQUEsQ0FBQSxPQURBLENBRUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSx3QkFBQSxDQUZBLENBSUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxvQkFBQSxDQUVBLENBTkEsQ0FKQSxDQVlBLE9BQUEsQ0FBQSxHQUFBLENBQUEsbUJBQUEsQ0FBQSxXQUFBLElBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQSxDQVpBOztBQWNBLHNCQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7QUFDQSxHQUFBLENBQUEsMEJBREE7QUFFQSxPQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBRkE7QUFHQSxDQWpCQTs7QUFtQkEsWUFBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBO0FBQ0EsR0FBQSxDQUFBLEdBQUEsQ0FBQSxnQkFBQTtBQUNBLE9BQUEsQ0FBQSxHQUFBLGtCQUFBLGVBQUEsQ0FBQSxDQUFBLFVBQUEsQ0FBQSxTQUFBLENBRkE7QUFHQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxTQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLDBCQUFBLENBSEE7QUFJQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxrQkFBQSxDQUpBO0FBS0EsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxNQUFBLENBQUEsS0FBQSxDQUFBOzs7QUFHQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxrQkFBQSxLQUFBLENBSEE7QUFJQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxTQUFBLE1BQUEsQ0FBQSxJQUFBLENBSkE7QUFLQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxVQUFBLE1BQUEsQ0FBQSxLQUFBLENBTEE7QUFNQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxVQUFBLE1BQUEsQ0FBQSxLQUFBLENBTkE7QUFPQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxjQUFBLE1BQUEsQ0FBQSxTQUFBLENBUEE7QUFRQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxhQUFBLE1BQUEsQ0FBQSxRQUFBLENBUkE7QUFTQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxTQUFBLE1BQUEsQ0FBQSxJQUFBLENBVEE7QUFVQSxPQUFBLENBQUEsR0FBQSxrQkFBQSxVQUFBLE1BQUEsQ0FBQSxLQUFBLENBVkE7QUFXQSxPQUFBLENBQUEsR0FBQSxDQUFBLGtCQUFBLENBWEE7O0FBYUEsR0FBQSxDQUFBLFVBQUEsQ0FB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VUFBQSxjQUFBLENBQUEsUUFBQSxDQUFBLFVBQUEsR0FBQSxDQUFBLFFBQUEsY0FsQkE7O0FBb0JBLEtBQUEsQ0FBQSxHQUFBLENBQUEsUUFBQSxDQUFBLEdBQUEsQ0FBQSxjQUFBLENBQUEsUUFBQSxDQUFBLFNBQUEsQ0FwQkE7QUFxQkEsQ0E1QkE7O0FBOEJBLEdBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxLQUFBLE1BQUEsQ0FEQTtBQUVBLE9BQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEtBQUEsWUFBQSxDQUZBOzs7QUFLQSxjQUFBLENBQUEsUUFBQSxDQUFBLFNBTEEsRUFHQSxLQUFBLE1BQUEsQ0FBQSxHQUhBLEVBS0EsZ0JBQUEsY0FBQSxDQUFBLFFBQUEsQ0FBQSxNQUFBLElBQUEsY0FBQSxDQUFBLFFBQUEsQ0FBQSxNQUFBLFNBTEE7Ozs7QUFTQSwwRUFUQTs7QUFXQSxDQXpDQTtBQTBDQSxHQUFBLENBQUEsT0FBQSxDQUFBLEdBMUNBO0FBMkNBLEdBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLG1EQUFBLFdBQUEsQ0EzQ0E7QUE0Q0EsR0FBQSxDQUFBLGdCQUFBLENBQUEsY0FBQSxDQUFBLGtCQUFBLENBNUNBO0FBNkNBLEdBQUEsQ0FBQSxJQUFBLEVBN0NBO0FBOENBOztBQUVBLFFBQUEsQ0FBQSxjQUFBLENBQUEsUUFBQSxDQUFBO0FBQ0EsR0FBQSxDQUFBLEdBQUEsQ0FBQSxjQUFBO0FBQ0EsTUFBQSxVQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxDQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FEQTs7O0FBSUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLFNBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLFNBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUpBO0FBS0EsQ0FBQSxDQUxBOztBQU9BLENBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsUUFBQSxDQVBBOzs7QUFVQSxPQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsU0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsU0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLENBVkE7QUFXQSxDQVhBOztBQWFBLENBYkE7QUFjQSxDQWRBO0FBZUE7O0FBRUEsUUFBQSxDQUFBLGVBQUE7QUFDQTtBQUNBLEdBQUEsQ0FBQSxtQkFEQTtBQUVBLGVBQUEsQ0FBQSxFQUZBO0FBR0EsYUFBQSxDQUFBLEVBSEE7OztBQU1BLElBQUEsR0FBQSxDQUFBLElBQUEsR0FBQSxDQUFBLGNBQUE7QUFDQSxPQUFBLENBQUEsR0FBQSxxQkFBQSxTQUFBLENBQUEsY0FBQSxDQUFBLElBQUEsQ0FBQSxDQURBOztBQUdBLGNBQUEsQ0FBQSxJQUFBLENBQUEsYUFIQTs7O0FBTUEsZUFBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsSUFBQSxDQUFBLENBTkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWdEQSxNQVJBLENBQUEsT0FBQSxDQUFBLEdBQUEscUJBQUEsa0JBQUEsQ0FBQSxlQUFBLENBUUEsQ0FQQSxlQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxNQUFBLENBQUEsQ0FPQSxDQU5BLGVBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxRQUFBLENBQUEsS0FBQSxDQUFBLENBQ0EsT0FBQSxDQUFBLEdBQUEscUJBQUEsY0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQURBLENBRUEsYUFBQSxDQUFBLGFBQUEsQ0FBQSxRQUFBLFNBQUEsQ0FBQSxTQUFBLENBQUEsUUFBQSxNQUFBLENBQUEsU0FBQSxDQUFBLFFBQUEsTUFBQSxDQUNBLFFBREEsQ0FDQSxRQUFBLEtBREEsQ0FDQSxJQUNBLENBSkEsQ0FNQSxD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InNvdXJjZXNDb250ZW50IjpbInZhciBBbGxveSA9IHJlcXVpcmUoJy9hbGxveScpLFxuXHRCYWNrYm9uZSA9IEFsbG95LkJhY2tib25lLFxuXHRfID0gQWxsb3kuXztcblxuXG5cblxuZnVuY3Rpb24gX19wcm9jZXNzQXJnKG9iaiwga2V5KSB7XG5cdHZhciBhcmcgPSBudWxsO1xuXHRpZiAob2JqKSB7XG5cdFx0YXJnID0gb2JqW2tleV0gfHwgbnVsbDtcblx0fVxuXHRyZXR1cm4gYXJnO1xufVxuXG5mdW5jdGlvbiBDb250cm9sbGVyKCkge1xuXHRcblx0cmVxdWlyZSgnL2FsbG95L2NvbnRyb2xsZXJzLycgKyAnQmFzZUNvbnRyb2xsZXInKS5hcHBseSh0aGlzLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcblx0dGhpcy5fX2NvbnRyb2xsZXJQYXRoID0gJ2luZXRfYmVhY29uL2JlYWNvbic7XG5cdHRoaXMuYXJncyA9IGFyZ3VtZW50c1swXSB8fCB7fTtcblxuXHRpZiAoYXJndW1lbnRzWzBdKSB7XG5cdFx0dmFyIF9fcGFyZW50U3ltYm9sID0gX19wcm9jZXNzQXJnKGFyZ3VtZW50c1swXSwgJ19fcGFyZW50U3ltYm9sJyk7XG5cdFx0dmFyICRtb2RlbCA9IF9fcHJvY2Vzc0FyZyhhcmd1bWVudHNbMF0sICckbW9kZWwnKTtcblx0XHR2YXIgX19pdGVtVGVtcGxhdGUgPSBfX3Byb2Nlc3NBcmcoYXJndW1lbnRzWzBdLCAnX19pdGVtVGVtcGxhdGUnKTtcblx0fVxuXHR2YXIgJCA9IHRoaXM7XG5cdHZhciBleHBvcnRzID0ge307XG5cdHZhciBfX2RlZmVycyA9IHt9O1xuXG5cdC8vIEdlbmVyYXRlZCBjb2RlIHRoYXQgbXVzdCBiZSBleGVjdXRlZCBiZWZvcmUgYWxsIFVJIGFuZC9vclxuXHQvLyBjb250cm9sbGVyIGNvZGUuIE9uZSBleGFtcGxlIGlzIGFsbCBtb2RlbCBhbmQgY29sbGVjdGlvblxuXHQvLyBkZWNsYXJhdGlvbnMgZnJvbSBtYXJrdXAuXG5cdFxuXG5cdC8vIEdlbmVyYXRlZCBVSSBjb2RlXG5cdGV4cG9ydHMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHt9O1xuXG5cdC8vIG1ha2UgYWxsIElEZWQgZWxlbWVudHMgaW4gJC5fX3ZpZXdzIGF2YWlsYWJsZSByaWdodCBvbiB0aGUgJCBpbiBhXG5cdC8vIGNvbnRyb2xsZXIncyBpbnRlcm5hbCBjb2RlLiBFeHRlcm5hbGx5IHRoZSBJRGVkIGVsZW1lbnRzIHdpbGxcblx0Ly8gYmUgYWNjZXNzZWQgd2l0aCBnZXRWaWV3KCkuXG5cdF8uZXh0ZW5kKCQsICQuX192aWV3cyk7XG5cblx0Ly8gQ29udHJvbGxlciBjb2RlIGRpcmVjdGx5IGZyb20gdGhlIGRldmVsb3BlcidzIGNvbnRyb2xsZXIgZmlsZVxuXHRfX01BUE1BUktFUl9DT05UUk9MTEVSX0NPREVfX1xuXG5cdC8vIEdlbmVyYXRlZCBjb2RlIHRoYXQgbXVzdCBiZSBleGVjdXRlZCBhZnRlciBhbGwgVUkgYW5kXG5cdC8vIGNvbnRyb2xsZXIgY29kZS4gT25lIGV4YW1wbGUgZGVmZXJyZWQgZXZlbnQgaGFuZGxlcnMgd2hvc2Vcblx0Ly8gZnVuY3Rpb25zIGFyZSBub3QgZGVmaW5lZCB1bnRpbCBhZnRlciB0aGUgY29udHJvbGxlciBjb2RlXG5cdC8vIGlzIGV4ZWN1dGVkLlxuXHRcblxuXHQvLyBFeHRlbmQgdGhlICQgaW5zdGFuY2Ugd2l0aCBhbGwgZnVuY3Rpb25zIGFuZCBwcm9wZXJ0aWVzXG5cdC8vIGRlZmluZWQgb24gdGhlIGV4cG9ydHMgb2JqZWN0LlxuXHRfLmV4dGVuZCgkLCBleHBvcnRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDb250cm9sbGVyO1xuIiwiLy8gbGV0IGJlYWNvblVVSUQgPSBcImM4YTk0ZjQyLTNjZDUtNDgzYS04YWRjLTk3NDczMTk3YjhiNFwiO1xubGV0IGJlYWNvblVVSUQgPSBcIjU5OTFlMTYxLWJiNDYtNDMyZi05YmQ4LWIyNzFmNzZmNjdkOVwiO1xubGV0IGJlYWNvbklkZW50aWZpZXIgPSBcIk1vcnByb21cIjtcbmxldCBnbG9iYWxfYmVhY29ucyA9IHt9O1xuXG5UaS5BcHAuUHJvcGVydGllcy5zZXRTdHJpbmcoXCJmX2JlYWNvblwiLCBcIlwiKTtcblxuZnVuY3Rpb24gcmVzZXRTdGF0ZUJlYWNvbigpIHtcbiAgVGkuQXBwLlByb3BlcnRpZXMuc2V0U3RyaW5nKFwiaW5ldEJlYWNvbkRhdGFfbWFqb3JcIiwgbnVsbCk7XG4gIFRpLkFwcC5Qcm9wZXJ0aWVzLnNldFN0cmluZyhcImluZXRCZWFjb25EYXRhX21pbm9yXCIsIG51bGwpO1xuICBUaS5BcHAuUHJvcGVydGllcy5zZXRTdHJpbmcoXCJpbmV0QmVhY29uRGF0YV91dWlkXCIsIG51bGwpO1xufVxuZnVuY3Rpb24gc2V0U3RhdGVCZWFjb24odXVpZCwgbWlub3IsIG1ham9yKSB7XG4gIFRpLkFwcC5Qcm9wZXJ0aWVzLnNldFN0cmluZyhcImluZXRCZWFjb25EYXRhX21ham9yXCIsIG1ham9yKTtcbiAgVGkuQXBwLlByb3BlcnRpZXMuc2V0U3RyaW5nKFwiaW5ldEJlYWNvbkRhdGFfbWlub3JcIiwgbWlub3IpO1xuICBUaS5BcHAuUHJvcGVydGllcy5zZXRTdHJpbmcoXCJpbmV0QmVhY29uRGF0YV91dWlkXCIsIHV1aWQpO1xufVxuZnVuY3Rpb24gaXNTYW1lU3RhdGVCZWZvcmUodXVpZCwgbWlub3IsIG1ham9yKSB7XG4gIGlmIChcbiAgdXVpZCA9PSBUaS5BcHAuUHJvcGVydGllcy5nZXRTdHJpbmcoXCJpbmV0QmVhY29uRGF0YV91dWlkXCIpICYmXG4gIG1ham9yID09IFRpLkFwcC5Qcm9wZXJ0aWVzLmdldFN0cmluZyhcImluZXRCZWFjb25EYXRhX21ham9yXCIpICYmXG4gIG1pbm9yID09IFRpLkFwcC5Qcm9wZXJ0aWVzLmdldFN0cmluZyhcImluZXRCZWFjb25EYXRhX21pbm9yXCIpKVxuICB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5jb25zb2xlLmxvZyhcImJlZ2luOlwiLCBNYXRoLmZsb29yKERhdGUubm93KCkpKTtcbnZhciBCTEUgPSBudWxsO1xuLy8gdmFyIGFuZHJvaWRQbGF0Zm9ybVRvb2xzID0gcmVxdWlyZSgnYmVuY29kaW5nLmFuZHJvaWQudG9vbHMnKS5jcmVhdGVQbGF0Zm9ybSgpO1xudmFyIGlzRm9yZWdyb3VuZCA9IHRydWU7XG5cbmlmIChPU19JT1MpXG57XG4gIEJMRSA9IHJlcXVpcmUoXCJhcHBjZWxlcmF0b3IuYmxlXCIpO1xufSBlbHNlXG57XG4gIEJMRSA9IHJlcXVpcmUoXCJjb20ubGlmZXJheS5iZWFjb25zXCIpO1xufVxuXG5mdW5jdGlvbiBpc0ludGVyZXN0ZWRSZWdpb24ocnNzaSlcbntcbiAgdGFnID0gXCJpc0ludGVyZXN0UmVnaW9uOlwiO1xuICBsZXQgbWluX3Jzc2kgPSAtOTY7XG4gIGlmIChPU19JT1MpXG4gIHtcbiAgICAvLyBpbnRlcmVzdGVkIGFsbFxuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2VcblxuICB7XG4gICAgaWYgKHJzc2kgPD0gbWluX3Jzc2kpXG4gICAge1xuICAgICAgLy8gbm90IGludGVyZXN0ZWQgcmVnaW9uXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlXG5cbiAgICB7XG4gICAgICAvLyBpbnRlcmVzdGVkIHJlZ2lvblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG59XG5cbmNvbnNvbGUubG9nKFwiYWZ0ZXIgbG9kZSBsaWI6XCIsIE1hdGguZmxvb3IoRGF0ZS5ub3coKSkpO1xuLy8gLS0tIGlvcyAtLS0tLS0tLS0tXG52YXIgbWFuYWdlciA9IG51bGw7XG52YXIgaW9zRGlkUmFuZ2VCZWFjb25zID0gbnVsbDtcbnZhciBpb3NEaWRDaGFuZ2VBdXRob3JpemF0aW9uID0gbnVsbDtcbi8vIC0tLSBhbmRyb2lkIC0tLS0tLS0tLS1cbnZhciBpbkJlY29uUmFuZ2UgPSBudWxsO1xuXG5mdW5jdGlvbiBiZWFjb25TdGFydFNjYW4oKSB7XG4gIHJlc2V0U3RhdGVCZWFjb24oKTtcbiAgaWYgKE9TX0lPUykge1xuICAgIC8vIC0tLS0tLS0tIElPUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGlvc0RpZENoYW5nZUF1dGhvcml6YXRpb24gPSAoZSkgPT4ge1xuICAgICAgVGkuQVBJLmluZm8oXCJkaWRDaGFuZ2VBdXRob3JpemF0aW9uXCIpO1xuICAgICAgc3dpdGNoIChlLnN0YXRlKSB7XG4gICAgICAgIGNhc2UgQkxFLkxPQ0FUSU9OX01BTkFHRVJfQVVUSE9SSVpBVElPTl9TVEFUVVNfQVVUSE9SSVpFRF9BTFdBWVM6XG4gICAgICAgICAgYWxlcnQoXCJNYW5hZ2VyIGF1dGhvcml6YXRpb24gaXMgYWx3YXlzXCIpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJMRS5MT0NBVElPTl9NQU5BR0VSX0FVVEhPUklaQVRJT05fU1RBVFVTX0FVVEhPUklaRURfV0hFTl9JTl9VU0U6XG4gICAgICAgICAgYWxlcnQoXCJNYW5hZ2VyIGF1dGhvcml6YXRpb24gaXMgd2hlbiBpbiB1c2VcIik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQkxFLkxPQ0FUSU9OX01BTkFHRVJfQVVUSE9SSVpBVElPTl9TVEFUVVNfREVOSUVEOlxuICAgICAgICAgIGFsZXJ0KFwiTWFuYWdlciBhdXRob3JpemF0aW9uIGlzIGRlbmllZFwiKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCTEUuTE9DQVRJT05fTUFOQUdFUl9BVVRIT1JJWkFUSU9OX1NUQVRVU19OT1RfREVURVJNSU5FRDpcbiAgICAgICAgICBhbGVydChcIk1hbmFnZXIgYXV0aG9yaXphdGlvbiBpcyBub3QgZGV0ZXJtaW5lZFwiKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCTEUuTE9DQVRJT05fTUFOQUdFUl9BVVRIT1JJWkFUSU9OX1NUQVRVU19SRVNUUklDVEVEOlxuICAgICAgICAgIGFsZXJ0KFwiTWFuYWdlciBhdXRob3JpemF0aW9uIGlzIHBvd2VyZWQgcmVzdHJpY3RlZFwiKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBhbGVydChcIlVua25vd25cIik7XG4gICAgICAgICAgYnJlYWs7fVxuXG4gICAgfTtcblxuICAgIGlvc0RpZFJhbmdlQmVhY29ucyA9IChlKSA9PiB7XG4gICAgICBUaS5BUEkuaW5mbyhcImRpZFJhbmdlQmVhY29uc1wiKTtcbiAgICAgIHZhciBiZWNhb25zID0gZS5iZWFjb25zO1xuXG5cbiAgICAgIGlmIChiZWNhb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIk5vIGJlYWNvbiBpbiByYW5nZVwiKTtcbiAgICAgICAgaWYgKFRpLkFwcC5Qcm9wZXJ0aWVzLmdldFN0cmluZyhcImluZXRCZWFjb25EYXRhX3V1aWRcIikgIT09IG51bGwpIHtcbiAgICAgICAgICBhbGVydChcbiAgICAgICAgICBcIkV4aXQgdXVpZDogXCIgK1xuICAgICAgICAgIFRpLkFwcC5Qcm9wZXJ0aWVzLmdldFN0cmluZyhcImluZXRCZWFjb25EYXRhX3V1aWRcIikgK1xuICAgICAgICAgIFwiICBNYWpvcjogXCIgK1xuICAgICAgICAgIFRpLkFwcC5Qcm9wZXJ0aWVzLmdldFN0cmluZyhcImluZXRCZWFjb25EYXRhX21ham9yXCIpICtcbiAgICAgICAgICBcIiAgTWlub3I6IFwiICtcbiAgICAgICAgICBUaS5BcHAuUHJvcGVydGllcy5nZXRTdHJpbmcoXCJpbmV0QmVhY29uRGF0YV9taW5vclwiKSk7XG5cbiAgICAgICAgICByZXNldFN0YXRlQmVhY29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgcHJveGltaXR5ID0gYmVjYW9uc1swXS5wcm94aW1pdHk7XG4gICAgICB2YXIgYWNjdXJhY3kgPSBiZWNhb25zWzBdLmFjY3VyYWN5O1xuICAgICAgdmFyIG1ham9yID0gYmVjYW9uc1swXS5tYWpvcjtcbiAgICAgIHZhciBtaW5vciA9IGJlY2FvbnNbMF0ubWlub3I7XG4gICAgICB2YXIgaGF2ZUNhc2UgPSB0cnVlO1xuXG4gICAgICAvLyBjaGVjayBzdGF0ZSBiZWZvcmVcblxuICAgICAgaWYgKCFpc0ludGVyZXN0ZWRSZWdpb24ocHJveGltaXR5KSlcbiAgICAgIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJUb28gZmFyLi4uXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGlzU2FtZVN0YXRlQmVmb3JlKGUucmVnaW9uLnV1aWQsIG1ham9yLCBtaW5vcikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKHByb3hpbWl0eSkge1xuICAgICAgICBjYXNlIEJMRS5CRUFDT05fUFJPWElNSVRZX1VOS05PV046XG4gICAgICAgICAgYWxlcnQoXCJCZWFjb24gTG9jYXRpb24gOiBVTktOT1dOXCIpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgQkxFLkJFQUNPTl9QUk9YSU1JVFlfSU1NRURJQVRFOlxuICAgICAgICAgIC8vIHNldCBiZWFjb24gc3RhdGUgb25seSwgYnV0IG5vdCB1c2UgcHJveGltaXR5XG4gICAgICAgICAgc2V0U3RhdGVCZWFjb24oZS5yZWdpb24udXVpZCwgbWFqb3IsIG1pbm9yKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlLnJlZ2lvbi51dWlkICsgXCIgTWFqb3I6IFwiICsgbWFqb3IgKyBcIiBNaW5vcjogXCIgKyBtaW5vcik7XG4gICAgICAgICAgYWxlcnQoXG4gICAgICAgICAgXCJJTU1FRElBVEUgdXVpZDogXCIgK1xuICAgICAgICAgIGUucmVnaW9uLnV1aWQgK1xuICAgICAgICAgIFwiICBNYWpvcjogXCIgK1xuICAgICAgICAgIG1ham9yICtcbiAgICAgICAgICBcIiAgTWlub3I6IFwiICtcbiAgICAgICAgICBtaW5vciArXG4gICAgICAgICAgXCIgIEFwcHJveDogXCIgK1xuICAgICAgICAgIGFjY3VyYWN5ICtcbiAgICAgICAgICBcIm0pXCIpO1xuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBCTEUuQkVBQ09OX1BST1hJTUlUWV9ORUFSOlxuICAgICAgICAgIHNldFN0YXRlQmVhY29uKGUucmVnaW9uLnV1aWQsIG1ham9yLCBtaW5vcik7XG4gICAgICAgICAgY29uc29sZS5sb2coZS5yZWdpb24udXVpZCArIFwiIE1ham9yOiBcIiArIG1ham9yICsgXCIgTWlub3I6IFwiICsgbWlub3IpO1xuICAgICAgICAgIGFsZXJ0KFxuICAgICAgICAgIFwiTkVBUiB1dWlkOiBcIiArXG4gICAgICAgICAgZS5yZWdpb24udXVpZCArXG4gICAgICAgICAgXCIgIE1ham9yOiBcIiArXG4gICAgICAgICAgbWFqb3IgK1xuICAgICAgICAgIFwiICBNaW5vcjogXCIgK1xuICAgICAgICAgIG1pbm9yICtcbiAgICAgICAgICBcIiAgQXBwcm94OiBcIiArXG4gICAgICAgICAgYWNjdXJhY3kgK1xuICAgICAgICAgIFwibSlcIik7XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIEJMRS5CRUFDT05fUFJPWElNSVRZX0ZBUjpcbiAgICAgICAgICBzZXRTdGF0ZUJlYWNvbihlLnJlZ2lvbi51dWlkLCBtYWpvciwgbWlub3IpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGUucmVnaW9uLnV1aWQgKyBcIiBNYWpvcjogXCIgKyBtYWpvciArIFwiIE1pbm9yOiBcIiArIG1pbm9yKTtcbiAgICAgICAgICBhbGVydChcbiAgICAgICAgICBcIkZBUiB1dWlkOiBcIiArXG4gICAgICAgICAgZS5yZWdpb24udXVpZCArXG4gICAgICAgICAgXCIgIE1ham9yOiBcIiArXG4gICAgICAgICAgbWFqb3IgK1xuICAgICAgICAgIFwiICBNaW5vcjogXCIgK1xuICAgICAgICAgIG1pbm9yICtcbiAgICAgICAgICBcIiAgQXBwcm94OiBcIiArXG4gICAgICAgICAgYWNjdXJhY3kgK1xuICAgICAgICAgIFwibSlcIik7XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGhhdmVDYXNlID0gZmFsc2U7XG4gICAgICAgICAgYWxlcnQoXCJCZWFjb24gTG9jYXRpb24gOiBVTktOT1dOXCIpO1xuICAgICAgICAgIGJyZWFrO31cblxuXG4gICAgICBpZiAoaGF2ZUNhc2UpIHtcbiAgICAgICAgLy8gcHV0QXBpKG1ham9yLCBtaW5vcik7XG4gICAgICAgIC8vIC4ucmVjb3JkIGJlYWNvblxuICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmIChtYW5hZ2VyID09PSBudWxsKSB7XG4gICAgICBtYW5hZ2VyID0gQkxFLmNyZWF0ZVJlZ2lvbk1hbmFnZXIoKTtcbiAgICAgIG1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwiZGlkQ2hhbmdlQXV0aG9yaXphdGlvblwiLFxuICAgICAgaW9zRGlkQ2hhbmdlQXV0aG9yaXphdGlvbik7XG5cbiAgICAgIG1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcImRpZFJhbmdlQmVhY29uc1wiLCBpb3NEaWRSYW5nZUJlYWNvbnMpO1xuXG4gICAgICB2YXIgYmVhY29uUmVnaW9uID0gQkxFLmNyZWF0ZUJlYWNvblJlZ2lvbih7XG4gICAgICAgIHV1aWQ6IGJlYWNvblVVSUQsXG4gICAgICAgIC8vIG1ham9yOiAzMjc3MixcbiAgICAgICAgLy8gbWlub3I6IDMsXG4gICAgICAgIGlkZW50aWZpZXI6IGJlYWNvbklkZW50aWZpZXIgfSk7XG5cbiAgICAgIG1hbmFnZXIuc3RhcnRSZWdpb25Nb25pdG9yaW5nKHtcbiAgICAgICAgYmVhY29uUmVnaW9uOiBiZWFjb25SZWdpb24gfSk7XG5cbiAgICAgIG1hbmFnZXIuc3RhcnRSYW5naW5nQmVhY29uc0luUmVnaW9uKHtcbiAgICAgICAgYmVhY29uUmVnaW9uOiBiZWFjb25SZWdpb24gfSk7XG5cbiAgICB9XG5cbiAgfSBlbHNlIHtcbiAgICAvLyAtLS0tLS0tLSBBbmRyb2lkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQ2hlY2sgUGVybWlzc2lvbiBMb2NhdGlvblxuICAgIHZhciBwZXJtaXNzaW9ucyA9IFtcImFuZHJvaWQucGVybWlzc2lvbi5BQ0NFU1NfRklORV9MT0NBVElPTlwiXTtcbiAgICBUaS5BbmRyb2lkLnJlcXVlc3RQZXJtaXNzaW9ucyhwZXJtaXNzaW9ucywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmIChlLnN1Y2Nlc3MpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJhbGxvdyBsb2NhdGlvbiBzdWNjZXNzXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJub3QgYWxsb3cgbG9jYXRpb25cIik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhcImFmdGVyIGNoZWNrIHBlcm06XCIsIE1hdGguZmxvb3IoRGF0ZS5ub3coKSkpO1xuXG4gICAgYW5kcm9pZEJpbmRpbmdDYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0YWcgPSBcImFuZHJvaWRCaW5kaW5nQ2FsbGJhY2s6IFwiO1xuICAgICAgY29uc29sZS5sb2codGFnLCBlKTtcbiAgICB9O1xuXG4gICAgaW5CZWNvblJhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciB0YWcgPSBcImJlYWNvblJhbmdlczogXCI7XG4gICAgICBjb25zb2xlLmxvZyh0YWcsIFwiSSBhbSBpbiB0aGUgXCIgKyBlLmlkZW50aWZpZXIgKyBcIiByZWdpb25cIik7XG4gICAgICBjb25zb2xlLmxvZyh0YWcsIFwiSSBzZWUgXCIgKyBlLmJlYWNvbnMubGVuZ3RoICsgXCIgYmVhY29ucyBpbiB0aGlzIHJlZ2lvbjpcIik7XG4gICAgICBjb25zb2xlLmxvZyh0YWcsIFwiLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgIGUuYmVhY29ucy5mb3JFYWNoKGZ1bmN0aW9uIChiZWFjb24sIGluZGV4KSB7XG4gICAgICAgIC8vIC4uLiBjaGVjayByc3NpIGFkZCB0byBkaWFsb2dcbiAgICAgICAgLy8gaWYgbm90IGludGVyZXN0ZWRSZWdpb24ocnNzaSkgLi4uIG5vdCBhZGQgdG8gY2hlY2tpbiBkaWFsb2dcbiAgICAgICAgY29uc29sZS5sb2codGFnLCBcIkJlYWNvbiBudW1iZXI6IFwiICsgaW5kZXgpO1xuICAgICAgICBjb25zb2xlLmxvZyh0YWcsIFwidXVpZDogXCIgKyBiZWFjb24udXVpZCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRhZywgXCJtYWpvcjogXCIgKyBiZWFjb24ubWFqb3IpO1xuICAgICAgICBjb25zb2xlLmxvZyh0YWcsIFwibWlub3I6IFwiICsgYmVhY29uLm1pbm9yKTtcbiAgICAgICAgY29uc29sZS5sb2codGFnLCBcInByb3hpbWl0eTogXCIgKyBiZWFjb24ucHJveGltaXR5KTtcbiAgICAgICAgY29uc29sZS5sb2codGFnLCBcImFjY3VyYWN5OiBcIiArIGJlYWNvbi5hY2N1cmFjeSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRhZywgXCJyc3NpOiBcIiArIGJlYWNvbi5yc3NpKTtcbiAgICAgICAgY29uc29sZS5sb2codGFnLCBcInBvd2VyOiBcIiArIGJlYWNvbi5wb3dlcik7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgLy8gLi4gZG8gb3RoZXJzIC4uLi5cbiAgICAgICAgdmFyIGJlYWNvbl9rZXkgPSBiZWFjb24ubWFqb3IgKyBcIi1cIiArIGJlYWNvbi5taW5vcjtcbiAgICAgICAgaWYgKGJlYWNvbl9rZXkgaW4gZ2xvYmFsX2JlYWNvbnMpXG4gICAgICAgIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhiZWFjb25fa2V5ICsgXCIgYmVhY29uIHdhcyByZWNvcmRlZFwiKTtcbiAgICAgICAgfSBlbHNlXG5cbiAgICAgICAge1xuICAgICAgICAgIGlmIChpc0ludGVyZXN0ZWRSZWdpb24oYmVhY29uLnJzc2kpKVxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRhZywgXCJjYWxsIGxvY2F0aW9uIGFwaVwiKTtcbiAgICAgICAgICAgIGdsb2JhbF9iZWFjb25zW2JlYWNvbl9rZXldID0ge1xuICAgICAgICAgICAgICBcIm1ham9yXCI6IGJlYWNvbi5tYWpvcixcbiAgICAgICAgICAgICAgXCJtaW5vclwiOiBiZWFjb24ubWlub3IsXG4gICAgICAgICAgICAgIFwicnNzaVwiOiBiZWFjb24ucnNzaSxcbiAgICAgICAgICAgICAgXCJsb2NhdGlvblwiOiBcIuC4geC4s+C4peC4seC4h+C4hOC5ieC4meC4q+C4suC4leC4s+C5geC4q+C4meC5iOC4h1wiLFxuICAgICAgICAgICAgICBcImlzUmVnaXN0ZXJlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgXCJ0c1wiOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSB9O1xuXG4gICAgICAgICAgICAvLyBjYWxsIGxvY2F0aW9vbiBhcGlcbiAgICAgICAgICAgIGdldExvY2F0aW9uKGJlYWNvbi5tYWpvciwgYmVhY29uLm1pbm9yLCBiZWFjb25fa2V5KTtcbiAgICAgICAgICB9IGVsc2VcblxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90IGludGVyZXNlZCByZWdpb24uXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIEJMRS5hZGRFdmVudExpc3RlbmVyKFwiYmVhY29uUmFuZ2VzXCIsIGluQmVjb25SYW5nZSk7XG5cbiAgICB2YXIgcmVnaW9uU3RhdGUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIHRhZyA9IFwicmVnaW9uU3RhdGU6IFwiO1xuICAgICAgY29uc29sZS5sb2codGFnLCBcImlkZW50aWZlcjogXCIgKyBlLnJlZ2lvblN0YXRlKTtcbiAgICB9O1xuXG4gICAgQkxFLmFkZEV2ZW50TGlzdGVuZXIoXCJvbklCZWFjb25TZXJ2aWNlQ29ubmVjdFwiLCBhbmRyb2lkQmluZGluZ0NhbGxiYWNrKTtcblxuICAgIGNvbnNvbGUubG9nKFwiYWRkIGV2bnQgY29tcGxldGU6XCIsIE1hdGguZmxvb3IoRGF0ZS5ub3coKSkpO1xuXG4gICAgdmFyIHdoZW5fcmVhZHk7XG4gICAgdmFyIG5vdF9yZWFkeV9jb3VudCA9IDA7XG5cbiAgICBCTEUuYmluZEJlYWNvblNlcnZpY2UoKTtcblxuICAgIHdoZW5fcmVhZHkgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIUJMRS5pc1JlYWR5KCkpXG4gICAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibm90X3JlYWR5X2NvdW50PVwiLCBub3RfcmVhZHlfY291bnQpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkJMRSBOb3QgcmVhZHlcIik7XG4gICAgICAgIG5vdF9yZWFkeV9jb3VudCsrO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIFRpLkFQSS5pbmZvKFwiVHJ5XCIsIG5vdF9yZWFkeV9jb3VudCwgXCJ0aW1lLCBcIiwgXCJPa2F5ISBNb2R1bGUgaXMgcmVhZHkhXCIpO1xuXG4gICAgICAvLyBjb25zb2xlLmxvZyhcImNoZWNrQXZhaWxhYmlsaXR5PVwiLCBCTEUuY2hlY2tBdmFpbGFiaWxpdHkoKSk7XG4gICAgICBpZiAoIUJMRS5jaGVja0F2YWlsYWJpbGl0eSgpKVxuICAgICAge1xuICAgICAgICBhbGVydChcIkl0J3Mgbm90IHN1cHBvcnQgaW4geW91ciBkZXZpY2UhXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIEJMRS5zZXRCYWNrZ3JvdW5kTW9kZShmYWxzZSk7XG4gICAgICBCTEUuc2V0U2NhblBlcmlvZHMoe1xuICAgICAgICBmb3JlZ3JvdW5kU2NhblBlcmlvZDogNTAwMCxcbiAgICAgICAgZm9yZWdyb3VuZEJldHdlZW5TY2FuUGVyaW9kOiAyMDAsXG4gICAgICAgIGJhY2tncm91bmRTY2FuUGVyaW9kOiA1MDAwLFxuICAgICAgICBiYWNrZ3JvdW5kQmV0d2VlblNjYW5QZXJpb2Q6IDIwMCB9KTtcblxuXG4gICAgICBCTEUuc3RhcnRNb25pdG9yaW5nRm9yUmVnaW9uKHtcbiAgICAgICAgaWRlbnRpZmllcjogYmVhY29uSWRlbnRpZmllcixcbiAgICAgICAgdXVpZDogYmVhY29uVVVJRCB9KTtcblxuXG4gICAgICBjbGVhckludGVydmFsKHdoZW5fcmVhZHkpO1xuICAgICAgd2hlbl9yZWFkeSA9IG51bGw7XG4gICAgfSwgMTAwMCk7XG5cbiAgICB2YXIgbW9uaXQ7XG5cbiAgICBtb25pdCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIHZhciBpc0ZvcmVncm91bmQgPSBhbmRyb2lkUGxhdGZvcm1Ub29scy5pc0luRm9yZWdyb3VuZCgpO1xuICAgICAgaWYgKCFpc0ZvcmVncm91bmQpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJBcHAgaW4gYmFja2dyb3VuZC4gU3RvcCBzY2FuLlwiKTtcbiAgICAgICAgQkxFLnN0b3BTY2FuKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBlbmQgYW5kcm9pZFxuICB9XG59XG5cbnZhciBjbGVhckJDQ2FjaGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gIHZhciB0YWcgPSBcInRpbWVUb0NsZWFyQkNDYWNoPzogXCI7XG4gIGZvciAodmFyIHByb3AgaW4gZ2xvYmFsX2JlYWNvbnMpIHtcbiAgICBjb25zb2xlLmxvZyh0YWcgKyBnbG9iYWxfYmVhY29uc1twcm9wXVtcImxvY2F0aW9uXCJdICsgXCIgdHM9XCIgKyBnbG9iYWxfYmVhY29uc1twcm9wXVtcInRzXCJdICsgXCIgbXNcIik7XG4gICAgaWYgKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gZ2xvYmFsX2JlYWNvbnNbcHJvcF1bXCJ0c1wiXSA+IDUgKiA2MCAqIDEwMDApXG4gICAge1xuICAgICAgY29uc29sZS5sb2coXCJZZXMsIGNsZWFyIGJlYWNvbiBjYWNoZS5cIik7XG4gICAgICBkZWxldGUgZ2xvYmFsX2JlYWNvbnNbcHJvcF07XG4gICAgfSBlbHNlXG5cbiAgICB7XG4gICAgICBjb25zb2xlLmxvZyh0YWcgKyBcIk5vLlwiKTtcbiAgICB9XG4gIH1cbn0sIDUwMDApO1xuXG5mdW5jdGlvbiBiZWFjb25TdG9wU2NhbigpIHtcbiAgcmVzZXRTdGF0ZUJlYWNvbigpO1xuICBpZiAoT1NfSU9TKSB7XG4gICAgbWFuYWdlci5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgIFwiZGlkQ2hhbmdlQXV0aG9yaXphdGlvblwiLFxuICAgIGlvc0RpZENoYW5nZUF1dGhvcml6YXRpb24pO1xuXG4gICAgbWFuYWdlci5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGlkUmFuZ2VCZWFjb25zXCIsIGlvc0RpZFJhbmdlQmVhY29ucyk7XG4gIH0gZWxzZSB7XG4gICAgQkxFLnN0b3BNb25pdG9yaW5nQWxsUmVnaW9ucygpO1xuICAgIEJMRS5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmVhY29uUmFuZ2VzXCIsIGluQmVjb25SYW5nZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0TG9jYXRpb24odGhpc19tYWpvciwgdGhpc19taW5vciwgdGhpc19rZXkpIHtcbiAgdGFnID0gXCJnZXRMb2NhdGlvbjogXCI7XG4gIHZhciB4aHIgPSBUaS5OZXR3b3JrLmNyZWF0ZUhUVFBDbGllbnQoKTtcbiAgLy8gaGFzaF92YWx1ZVxuICB2YXIgbXlfbG9jX2NvZGUgPSBtZDVfaGFzaChgYjFjZjRiN2VjMjAzOjE6JHt0aGlzX21ham9yfToke3RoaXNfbWlub3J9YCk7XG4gIGNvbnNvbGUubG9nKHRhZyArIFwibXlfaGFzaDogXCIgKyBteV9sb2NfY29kZSArIFwiIG1ham9yOlwiICsgdGhpc19tYWpvciArIFwiIG1pbm9yOlwiICsgdGhpc19taW5vcik7XG5cbiAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIHJlc19qc29uID0ge307XG4gICAgY29uc29sZS5sb2codGFnLCB0aGlzLnN0YXR1cyk7XG4gICAgY29uc29sZS5sb2codGFnLCB0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgLy8gYWxlcnQodGFnICsgdGhpcy5yZXNwb25zZVRleHQpO1xuICAgIHJlc19qc29uID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgZ2xvYmFsX2JlYWNvbnNbdGhpc19rZXldW1wiaXNSZWdpc3RlcmVkXCJdID0gdHJ1ZTtcbiAgICBjb25zb2xlLmxvZyh0YWcsIFwicmVzX2pzb249XCIsIHJlc19qc29uKTtcbiAgICBpZiAoXCJzaXRlX25hbWVcIiBpbiByZXNfanNvbilcbiAgICB7XG4gICAgICBnbG9iYWxfYmVhY29uc1t0aGlzX2tleV1bXCJsb2NhdGlvblwiXSA9IHJlc19qc29uW1wic2l0ZV9uYW1lXCJdO1xuICAgIH0gZWxzZVxuXG4gICAge1xuICAgICAgZ2xvYmFsX2JlYWNvbnNbdGhpc19rZXldW1wibG9jYXRpb25cIl0gPSBcIi1cIjtcbiAgICB9XG4gICAgaWYgKFwibG9jYXRpb25fbmFtZVwiIGluIHJlc19qc29uKVxuICAgIHtcbiAgICAgIGdsb2JhbF9iZWFjb25zW3RoaXNfa2V5XVtcImxvY2F0aW9uXCJdID0gZ2xvYmFsX2JlYWNvbnNbdGhpc19rZXldW1wibG9jYXRpb25cIl0gKyBcIiBcIiArIHJlc19qc29uW1wibG9jYXRpb25fbmFtZVwiXTtcbiAgICB9XG4gICAgYWxlcnQodGFnICsgdGhpc19rZXkgKyBcIjpcIiArIGdsb2JhbF9iZWFjb25zW3RoaXNfa2V5XVtcImxvY2F0aW9uXCJdKTtcbiAgfTtcblxuICB4aHIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgY29uc29sZS5sb2codGFnLCB0aGlzLnN0YXR1cyk7XG4gICAgY29uc29sZS5sb2codGFnLCB0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgaWYgKHRoaXMuc3RhdHVzID0gNDA0KVxuICAgIHtcbiAgICAgIGdsb2JhbF9iZWFjb25zW3RoaXNfa2V5XVtcImxvY2F0aW9uXCJdID0gYOC5hOC4oeC5iOC4nuC4muC4leC4s+C5geC4q+C4meC5iOC4hyAke2dsb2JhbF9iZWFjb25zW3RoaXNfa2V5XVtcIm1ham9yXCJdfS8ke2dsb2JhbF9iZWFjb25zW3RoaXNfa2V5XVtcIm1ham9yXCJdfSDguYPguJnguKPguLDguJrguJpgO1xuICAgIH0gZWxzZVxuXG4gICAge1xuICAgICAgZ2xvYmFsX2JlYWNvbnNbdGhpc19rZXldW1wibG9jYXRpb25cIl0gPSBcIuC4geC4o+C4uOC4k+C4suC4peC4reC4h+C5g+C4q+C4oeC5iFwiO1xuICAgIH1cbiAgfTtcbiAgeGhyLnRpbWVvdXQgPSAxMDAwMDtcbiAgeGhyLm9wZW4oJ0dFVCcsICdodHRwczovL2JlYWNvbi10cmFjay5pbmV0LmNvLnRoL2JlYWNvbmluZm8/Y29kZT0nICsgbXlfbG9jX2NvZGUpO1xuICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcImNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gIHhoci5zZW5kKCk7XG59XG5cbmZ1bmN0aW9uIHNvcnRCeVByb3BlcnR5KHByb3BlcnR5KSB7XG4gIHZhciB0YWcgPSBcInNvcnRCeVByb3A6IFwiO1xuICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBpZiAoYVtwcm9wZXJ0eV0gPiBiW3Byb3BlcnR5XSlcbiAgICB7XG4gICAgICAvLyBhbGVydChhW1wibG9jYXRpb25cIl0gKyBcIiBcIiArIGFbcHJvcGVydHldICsgXCI+XCIgKyBiW1wibG9jYXRpb25cIl0gKyBcIiBcIiArIGJbcHJvcGVydHldKTtcbiAgICAgIGNvbnNvbGUubG9nKGFbXCJsb2NhdGlvblwiXSArIFwiIFwiICsgYVtwcm9wZXJ0eV0gKyBcIj5cIiArIGJbXCJsb2NhdGlvblwiXSArIFwiIFwiICsgYltwcm9wZXJ0eV0pO1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH0gZWxzZVxuICAgIGlmIChhW3Byb3BlcnR5XSA8IGJbcHJvcGVydHldKVxuICAgIHtcbiAgICAgIC8vIGFsZXJ0KGFbXCJsb2NhdGlvblwiXSArIFwiIFwiICsgYVtwcm9wZXJ0eV0gKyBcIjxcIiArIGJbXCJsb2NhdGlvblwiXSArIFwiIFwiICsgYltwcm9wZXJ0eV0pO1xuICAgICAgY29uc29sZS5sb2coYVtcImxvY2F0aW9uXCJdICsgXCIgXCIgKyBhW3Byb3BlcnR5XSArIFwiPFwiICsgYltcImxvY2F0aW9uXCJdICsgXCIgXCIgKyBiW3Byb3BlcnR5XSk7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldExvY2F0aW9uTGlzdCgpXG57XG4gIHZhciB0YWcgPSBcImdldExvY2F0aW9uTGlzdDogXCI7XG4gIHZhciBnbG9iYWxfbG9jYXRpb24gPSBbXTtcbiAgdmFyIGxvY2F0aW9uX2xpc3QgPSBcIlwiO1xuICAvLyBjcmVhdGUgYXJyIG9mIGpzb24gb2YgbG9jYXRpb25zLCBmaWx0ZXIgb25seSByZWdpc3RlcmVkIGRldmljZVxuXG4gIGZvciAodmFyIHByb3AgaW4gZ2xvYmFsX2JlYWNvbnMpIHtcbiAgICBjb25zb2xlLmxvZyh0YWcsIFwiYmVhY29uIFwiLCBnbG9iYWxfYmVhY29uc1twcm9wXSk7XG4gICAgLy8gYnJpbm5nIHJlZ2lzdGVyZWQgcmVnaW9uIGZpcnN0IVxuICAgIGlmIChnbG9iYWxfYmVhY29uc1twcm9wXVtcImlzUmVnaXN0ZXJlZFwiXSlcbiAgICB7XG4gICAgICAvLyBhZGQgdG8gbG9jYXRpb24gbGlzdFxuICAgICAgZ2xvYmFsX2xvY2F0aW9uLnB1c2goZ2xvYmFsX2JlYWNvbnNbcHJvcF0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIGNoZWNrIG51bWJlciBvZiBsb2NhdGlvbiBpcyBsZXNzIHRoYW4gMFxuXG4gIC8qXHJcbiAgdmFyIG1heF9sb2NhdGlvbiA9IDM7XHJcbiAgaWYoKGdsb2JhbF9iZWFjb25zLmxlbmd0aCA+IGdsb2JhbF9sb2NhdGlvbi5sZW5ndGgpICYmIChnbG9iYWxfbG9jYXRpb24gPCBtYXhfbG9jYXRpb24pKSBcclxuICB7XHJcbiAgICAvLyBhZGQgbm9uIHJlZ2lzdGVyZWQgYmVhY29uIGZvciBzaG93XHJcbiAgICBmb3IodmFyIHByb3AgaW4gZ2xvYmFsX2JlYWNvbnMpIHtcclxuICAgICAgaWYoISBnbG9iYWxfYmVhY29uc1twcm9wXVtcImlzUmVnaXN0ZXJlZFwiXSlcclxuICAgICAge1xyXG4gICAgICAgIGdsb2JhbF9sb2NhdGlvbi5wdXNoKGdsb2JhbF9iZWFjb25zW3Byb3BdKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYoZ2xvYmFsX2xvY2F0aW9uLmxlbmd0aCA+PSBtYXhfbG9jYXRpb24pXHJcbiAgICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0YWcsIFwibG9jYXRpb24gcmVhY2ggbGltaXQ9XCIsIG1heF9sb2NhdGlvbik7XHJcbiAgICAgICAgLy8gc29ydGluZyBieSByc3NpICBnZXRTb3J0T3JkZXIocHJvcClcclxuICAgICAgICBnbG9iYWxfc29ydGluZ19sb2MgPSBnbG9iYWxfbG9jYXRpb24uc29ydChnZXRTb3J0T3JkZXJbXCJyc3NpXCJdKTtcclxuICAgICAgICBnbG9iYWxfc29ydGluZ19sb2MuZm9yRWFjaChmdW5jdGlvbihsb2NfbGlzdCwgaW5kZXgpe1xyXG4gICAgICAgICAgY29uc29sZS5sb2codGFnLCBcInNvcnRlZF9sb2M9XCIsIGxvY19saXN0KTtcclxuICAgICAgICAgIGxvY2F0aW9uX2xpc3QgPSBsb2NhdGlvbl9saXN0ICsgbG9jX2xpc3RbXCJtYWpvclwiXSArIFwiLVwiICsgbG9jX2xpc3RbXCJtaW5vclwiXSArIFxyXG4gICAgICAgICAgXCI6XCIgKyBsb2NfbGlzdFtcImxvY2F0aW9uXCJdICsgXCIgXCIgKyBsb2NfbGlzdFtcInJzc2lcIl0gKyBcImRCbVwiICsgXCI7IFwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFsZXJ0KHRhZyArIGxvY2F0aW9uX2xpc3QpO1xyXG4gICAgICAgIHJldHVybiBnbG9iYWxfc29ydGluZ19sb2M7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgKi9cblxuICBjb25zb2xlLmxvZyh0YWcsIFwiZ2xvYmFsX2xvY2F0aW9uPVwiLCBnbG9iYWxfbG9jYXRpb24pO1xuICBnbG9iYWxfbG9jYXRpb24uc29ydChzb3J0QnlQcm9wZXJ0eShcInJzc2lcIikpO1xuICBnbG9iYWxfbG9jYXRpb24uZm9yRWFjaChmdW5jdGlvbiAoc29ydF9sb2MsIGluZGV4KSB7XG4gICAgY29uc29sZS5sb2codGFnLCBcIiMjIyBzb3J0X2lkPVwiLCBpbmRleCwgXCJkYXRhPVwiLCBzb3J0X2xvYyk7XG4gICAgbG9jYXRpb25fbGlzdCA9IGxvY2F0aW9uX2xpc3QgKyBzb3J0X2xvY1tcImxvY2F0aW9uXCJdICsgXCIgbWFqb3I9XCIgKyBzb3J0X2xvY1tcIm1ham9yXCJdICsgXCIgbWlub3I9XCIgKyBzb3J0X2xvY1tcIm1pbm9yXCJdICtcbiAgICBcIiByc3NpPVwiICsgc29ydF9sb2NbXCJyc3NpXCJdICsgXCI7IFwiO1xuICB9KTtcbiAgYWxlcnQodGFnICsgXCJzb3J0ZWRfbG9jPVwiICsgbG9jYXRpb25fbGlzdCk7XG4gIHJldHVybiBnbG9iYWxfbG9jYXRpb247XG59XG5cbmZ1bmN0aW9uIG1kNV9oYXNoKGhhc2hfc2VlZCkge1xuICB2YXIgdGFnID0gXCJtZDVfaGFzaFwiO1xuICB2YXIgbXlfbWQ1ID0gVGkuVXRpbHMubWQ1SGV4RGlnZXN0KGhhc2hfc2VlZCk7XG4gIHJldHVybiBteV9tZDU7XG59XG5cbmV4cG9ydHMuYmVhY29uU3RhcnRTY2FuID0gYmVhY29uU3RhcnRTY2FuO1xuZXhwb3J0cy5iZWFjb25TdG9wU2NhbiA9IGJlYWNvblN0b3BTY2FuO1xuZXhwb3J0cy5nZXRMb2NhdGlvbkxpc3QgPSBnZXRMb2NhdGlvbkxpc3Q7Il0sInNvdXJjZVJvb3QiOiJkOlxcR0lBTlRcXHd3MlxcYmMtZGVidWdcXGluZXR0aWJlYWNvbiJ9
